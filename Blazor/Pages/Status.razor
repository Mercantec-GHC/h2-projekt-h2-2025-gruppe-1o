@page "/status"
@using DomainModels
@using Blazor.Components

<PageTitle>System Status</PageTitle>

<h1 class="mb-4">Status Dashboard</h1>

<div class="row">
    <div class="col-md-6 mb-4">
        <StatusCard Title="API Status"
                    IconClass="bi bi-heart-pulse text-success"
                    BorderClass="border-success"
                    HealthCheck="@healthCheck" />
    </div>
    <div class="col-md-6 mb-4">
        <StatusCard Title="Database Status"
                    IconClass="bi bi-database text-warning"
                    BorderClass="border-warning"
                    HealthCheck="@dbHealthCheck" />
    </div>
</div>

@code {
    [Inject]
    private APIService ApiService { get; set; } = default!;

    private HealthCheckResponse? healthCheck;
    private HealthCheckResponse? dbHealthCheck;

    protected override async Task OnInitializedAsync()
    {
        // We call the one valid health check endpoint
        healthCheck = await ApiService.GetHealthCheckAsync();

        // We reuse the same result for the DB status card for simplicity.
        // This assumes the API's health check also verifies the database connection.
        dbHealthCheck = healthCheck;
    }
}