@page "/rooms"
@using DomainModels.DTOs
@using Blazor.Components
@using System.Globalization
@inject APIService ApiService
@inject NavigationManager Navigation

<PageTitle>Vores Værelser - Flyhigh Hotel</PageTitle>

<div class="container my-5">
    <h1 class="text-center mb-4">Udforsk Vores Værelser</h1>

    @if (_roomTypes is null)
    {
        <p class="text-center"><em>Indlæser værelser...</em></p>
    }
    else
    {
        <div class="row g-4">
            @foreach (var roomType in _roomTypes)
            {
                <div class="col-lg-4 col-md-6">
                    <div class="card h-100 shadow-sm room-page-card" @onclick="@(() => NavigateToRoomDetails(roomType.Id))">
                        <img src="@GetRoomImagePath(roomType.Name)" class="card-img-top" alt="@roomType.Name" style="height: 200px; object-fit: cover;" />
                        <div class="card-body d-flex flex-column">
                            <h5 class="card-title">@roomType.Name</h5>
                            <p class="card-text text-muted flex-grow-1">@roomType.Description</p>
                            <p class="card-text">Fra <strong>@roomType.BasePrice.ToString("C0", _danishCulture)</strong> / nat</p>
                            <div class="mt-auto d-grid">
                                <ActionButton>Udforsk Værelset</ActionButton>
                            </div>
                        </div>
                    </div>
                </div>
            }
        </div>
    }
</div>

<style>
    .room-page-card {
        border: 1px solid #dee2e6;
        transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        cursor: pointer;
    }

        .room-page-card:hover {
            transform: scale(1.03);
            box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
            border-color: #0d6efd;
        }
</style>

@code {
    private List<RoomTypeGetDto>? _roomTypes;
    private readonly CultureInfo _danishCulture = new("da-DK");

    protected override async Task OnInitializedAsync()
    {
        _roomTypes = await ApiService.GetAllRoomTypesAsync();
    }

    private void NavigateToRoomDetails(int roomTypeId)
    {
        Navigation.NavigateTo($"/room/{roomTypeId}");
    }

    private string GetRoomImagePath(string roomTypeName) => roomTypeName switch
    {
        "Standard Værelse" => "images/room-standard.png",
        "Deluxe Suite" => "images/room-deluxe.png",
        "Presidential Suite" => "images/room-presidential.png",
        _ => ""
    };
}