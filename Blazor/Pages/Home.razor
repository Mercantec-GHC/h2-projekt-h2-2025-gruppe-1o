@page "/"
@using Blazor.Components
@using DomainModels.DTOs 
@inject NavigationManager Navigation
@inject APIService ApiService

<PageTitle>Velkommen til Flyhigh Hotel</PageTitle>

<div class="hero-section">
    <div class="hero-overlay"></div>
    <div class="hero-content">
        <h1 class="hero-title">Velkommen til Flyhigh Hotel</h1>
        <p class="hero-subtitle">Book dit luksusophold over skyerne</p>
    </div>
</div>

<div class="search-section">
    <BookingSearchForm />
</div>

<div class="page-section">
    <h2 class="section-title">Vores Værelsestyper</h2>
    <p class="section-subtitle">Oplev luksus og komfort i vores nøje udvalgte værelser</p>
    
    @if (featuredRooms is null)
    {
        <p><em>Indlæser værelser...</em></p>
    }
    else
    {
        <div class="room-types-grid">
            @foreach (var room in featuredRooms)
            {
                <RoomTypeCard RoomType="room" OnButtonClicked="ViewRoomDetails" />
            }
        </div>
    }
</div>

@code {
    private List<RoomTypeGetDto> featuredRooms;

    // 1. Hent data fra din service, når siden indlæses
    protected override async Task OnInitializedAsync()
    {
        var allRooms = await ApiService.GetAllRoomTypesAsync();
        // Vi tager de første 3 rum til at vise på forsiden
        featuredRooms = allRooms?.Take(3).ToList();
    }

    // 2. Håndter navigation, når der klikkes på en knap
    private void ViewRoomDetails(int roomTypeId)
    {
        // Vi navigerer til den nye, korrekte URL for detaljesiden
        Navigation.NavigateTo($"/room/{roomTypeId}");
    }
}